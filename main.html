<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="content-language" content="en" />
	<title>Notícias do Santos</title>
	<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
	<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

	<!-- Optional theme -->
	<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
	<link href="css/FeedEk.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript" src="http://momentjs.com/downloads/moment-with-langs.min.js"></script>
	<script type="text/javascript" src="js/FeedEk.js"></script>

	<!-- Latest compiled and minified JavaScript -->
	<script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/scrolltop.js"></script>
	
	<script type="text/javascript">
		var x = window.scrollX,
			y = window.scrollY;
		function titulo(data){
			return $(data).find('.entry-title').html();
		}
		function descricao(data){
			return $(data).find('.materia-titulo > h2').html();
		}
		function noticia(data){

			var dom = $(data).find('.materia-conteudo > div');
			dom.find('.saibamais').remove();
			dom.find('a').each(function () {
				this.href=''
			});
			return dom.html();
		}
		$(function(){
			
			$("#loading").hide();
			$('#inicio').click(function() {
				$('#feed').FeedEk({
					FeedUrl: 'http://globoesporte.globo.com/servico/semantica/editorias/plantao/futebol/times/santos/feed.rss',
					MaxCount: 1000,
					success:function(feed){
						window.scrollTo(x,y);
						x=y=0;
					}
				});
			});
			$('#feed').FeedEk({
				FeedUrl: 'http://globoesporte.globo.com/servico/semantica/editorias/plantao/futebol/times/santos/feed.rss',
				MaxCount: 1000,
			});
			jQuery(document).on('click','#feed a',function () {
				if (this.href!=location.href) {
					// get scroll position
					x = window.scrollX;
					y = window.scrollY;
					$('#feed').hide();
					$("#loading").show();
					
					var query = 'select * from html where url="'+this.href+'" AND xpath=\'//div[@id="glb-materia"]\''
					var q = encodeURIComponent(query);
					var yql = 'http://query.yahooapis.com/v1/public/yql?q='+q;
					var retorno;
					$.ajax({
						type: "GET",
						url: yql,
						
						dataType: "html",
						success: function (data) {
							$('#feed').html('<h1>'+titulo(data)+'</h1>'+'<h2>'+descricao(data)+'</h2>'+noticia(data));
							$('#feed').show();
							$("#loading").hide();
							$('#btn-scroll').click();
						}
					});
					
					
					
					
				};

				return false
			});
			
		});
</script>

</head>
<body>
	<nav class="navbar navbar-default fixed" role="navigation">
		<div id="logo">
			<img src="icon.png" width="56px" >
		</div>
		<div class="container-fluid">

			<div class="navbar-header">
				<a class="navbar-brand" href="#" id="inicio">Início</a>
			</div>
		</div>
	</nav>
	<div><img src="loader.gif" id="loading"></div>
	<div id="feed" class="rssDiv">


		<div style="padding: 10px;">
			<div>
				<div class="rssDiv">

					<div id="divRss"></div>

				</div>
				<div style="clear: both"></div>
			</div>
		</div>

	</div>
	
</body>
</html>
